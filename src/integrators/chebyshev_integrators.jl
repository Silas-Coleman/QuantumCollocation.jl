"""
This file includes chebyshev integrators for states and unitaries
"""

function nth_order_chebyshev(Gₜ::Matrix, n::Int)
    """
    Compute the nth order chebyshev approximation for the exponential of matrix Gₜ
    
    Inputs:
        Gₜ (Matrix): Matrix to exponetiate and approximate
        n (int): polynomial order of approximation
    
    Returns: nth order chebyshev approximation of the exponential of Gₜ
    """
    @assert n >= 0
    polynomial_coefficients = CHEBYSHEV_POLYNOMIAL_COEFFICIENTS[k]
    Id = 1.0I(size(Gₜ, 1))
    Gₜ_powers = compute_powers(Gₜ,n)
    C = CHEBYSHEV_COEFFICIENTS[0] * Id + sum(CHEBYSHEV_COEFFICIENTS[k] * polynomial_coefficients[k-n] * Gₜ_powers[k] for k = 1:n)
    return C
end

const CHEBYSHEV_COEFFICIENTS = OrderedDict{Int,Vector{Float64}}(
    0 => [1.266065877752008406176287280687],
    1 => [0.000000000000000000000000000000,1.130318207984970069190922004054],
    2 => [-1.266065877752008406176287280687,0.000000000000000000000000000000,0.542990679068153125896856181498],
    3 => [0.000000000000000000000000000000,-3.390954623954910207572766012163,0.000000000000000000000000000000,0.177347399394655214077687332974],
    4 => [1.266065877752008406176287280687,0.000000000000000000000000000000,-2.171962716272612503587424725993,0.000000000000000000000000000000,0.043793923536749858327343787323],
    5 => [0.000000000000000000000000000000,5.651591039924850790043819870334,0.000000000000000000000000000000,-0.886736996973276125899587896129,0.000000000000000000000000000000,0.008686820990623100521843547028],
    6 => [-1.266065877752008406176287280687,0.000000000000000000000000000000,4.886916111613378355116310558515,0.000000000000000000000000000000,-0.262763541220499163841850531753,0.000000000000000000000000000000,0.001439274334537444773388092933],
    7 => [0.000000000000000000000000000000,-7.912227455894790040247244178317,0.000000000000000000000000000000,2.482863591525172886065320199123,0.000000000000000000000000000000,-0.060807746934361701918181353221,0.000000000000000000000000000000,0.000204699933593727390534686150],
    8 => [1.266065877752008406176287280687,0.000000000000000000000000000000,-8.687850865090450014349698903970,0.000000000000000000000000000000,0.875878470734997138791300130833,0.000000000000000000000000000000,-0.011514194676299558187104743467,0.000000000000000000000000000000,0.000025499197525411785886662736],
    9 => [0.000000000000000000000000000000,10.172863871864731066807507886551,0.000000000000000000000000000000,-5.320421981839656311308317526709,0.000000000000000000000000000000,0.234544166746823712355052293788,0.000000000000000000000000000000,-0.001842299402343546433497012416,0.000000000000000000000000000000,0.000002825413561732440023558429],
    10 => [-1.266065877752008406176287280687,0.000000000000000000000000000000,13.574766976703827481287589762360,0.000000000000000000000000000000,-2.189696176837492735955947864568,0.000000000000000000000000000000,0.050374601708810563815976735214,0.000000000000000000000000000000,-0.000254991975254117845314100199,0.000000000000000000000000000000,0.000000281901879279295869344359],
    11 => [0.000000000000000000000000000000,-12.433500287834670317010932194535,0.000000000000000000000000000000,9.754106966706036274672442232259,0.000000000000000000000000000000,-0.668885216277978700283313173713,0.000000000000000000000000000000,0.009006797078124005942467711350,0.000000000000000000000000000000,-0.000031079549179056842800241561,0.000000000000000000000000000000,0.000000025579075757926220431858],
    12 => [1.266065877752008406176287280687,0.000000000000000000000000000000,-19.547664446453513420465242234059,0.000000000000000000000000000000,4.598361971358735367232384305680,0.000000000000000000000000000000,-0.161198725468193804211125552683,0.000000000000000000000000000000,0.001376956666372236397222206250,0.000000000000000000000000000000,-0.000003382822551351550220374072,0.000000000000000000000000000000,0.000000002128183768429711374033],
    13 => [0.000000000000000000000000000000,14.694136703804611343571195902769,0.000000000000000000000000000000,-16.138613344913625979870630544610,0.000000000000000000000000000000,1.581001420293404402528381069715,0.000000000000000000000000000000,-0.031933189640621473248671691181,0.000000000000000000000000000000,0.000183651881512608602378330835,0.000000000000000000000000000000,-0.000000332527984853040865614160,0.000000000000000000000000000000,0.000000000163482147078733886824],
    14 => [-1.266065877752008406176287280687,0.000000000000000000000000000000,26.606543274339504279168977518566,0.000000000000000000000000000000,-8.583609013202972093381504237186,0.000000000000000000000000000000,0.423146654354008777687567999237,0.000000000000000000000000000000,-0.005354831480336475456327516298,0.000000000000000000000000000000,0.000021706444704505782627729921,0.000000000000000000000000000000,-0.000000029794572758015957582107,0.000000000000000000000000000000,0.000000000011663425624683783565],
    15 => [0.000000000000000000000000000000,-16.954773119774550593774620210752,0.000000000000000000000000000000,24.828635915251730637010041391477,0.000000000000000000000000000000,-3.283618334455531861948429650511,0.000000000000000000000000000000,0.092114970117177327746382786700,0.000000000000000000000000000000,-0.000776988729476421049677248298,0.000000000000000000000000000000,0.000002302116818213359732988145,0.000000000000000000000000000000,-0.000000002452232206181008483306,0.000000000000000000000000000000,0.000000000000776753332643675539],
    16 => [1.266065877752008406176287280687,0.000000000000000000000000000000,-34.751403460361800057398795615882,0.000000000000000000000000000000,14.714758308347953175143629778177,0.000000000000000000000000000000,-0.967192352809162936289055778616,0.000000000000000000000000000000,0.016829470366771778766512568382,0.000000000000000000000000000000,-0.000099229461506312151091412088,0.000000000000000000000000000000,0.000000221331111916689989516921,0.000000000000000000000000000000,-0.000000000186614809994940537038,0.000000000000000000000000000000,0.000000000000048502540114601584],
    17 => [0.000000000000000000000000000000,19.215409535744491620334883918986,0.000000000000000000000000000000,-36.178869476509660785268351901323,0.000000000000000000000000000000,6.202390187304893665043437067652,0.000000000000000000000000000000,-0.229673325492162128114159713732,0.000000000000000000000000000000,0.002641761680219831265326035918,0.000000000000000000000000000000,-0.000011305951485003388901485859,0.000000000000000000000000000000,0.000000019454375502369332092621,0.000000000000000000000000000000,-0.000000000013204806654942484372,0.000000000000000000000000000000,0.000000000000002850763240206795],
    18 => [-1.266065877752008406176287280687,0.000000000000000000000000000000,43.982245004520400755154696526006,0.000000000000000000000000000000,-23.648718709844924745766547857784,0.000000000000000000000000000000,1.994834227668898396501617753529,0.000000000000000000000000000000,-0.045439569990283805445141496193,0.000000000000000000000000000000,0.000362807718632453767276108136,0.000000000000000000000000000000,-0.000001161988337562622358937049,0.000000000000000000000000000000,0.000000001574562459332310757024,0.000000000000000000000000000000,-0.000000000000873045722062828519,0.000000000000000000000000000000,0.000000000000000158260124356779],
    19 => [0.000000000000000000000000000000,-21.476045951714432646895147627220,0.000000000000000000000000000000,50.544008827476737621964275604114,0.000000000000000000000000000000,-10.893273522241367246010668168310,0.000000000000000000000000000000,0.513387433453068253719209224073,0.000000000000000000000000000000,-0.007676648647227039649887370132,0.000000000000000000000000000000,0.000044226221985454432109128448,0.000000000000000000000000000000,-0.000000108715627807358032282293,0.000000000000000000000000000000,0.000000000118066506561838673917,0.000000000000000000000000000000,-0.000000000000054164501563929105,0.000000000000000000000000000000,0.000000000000000008324007165532],
    20 => [1.266065877752008406176287280687,0.000000000000000000000000000000,-54.299067906815309925150359049439,0.000000000000000000000000000000,36.129986917818634140076028415933,0.000000000000000000000000000000,-3.799684243178854003986089082900,0.000000000000000000000000000000,0.109391557384016555043437790573,0.000000000000000000000000000000,-0.001128735124634300561116684314,0.000000000000000000000000000000,0.000004841618073177593338702902,0.000000000000000000000000000000,-0.000000009330740499747027627378,0.000000000000000000000000000000,0.000000000008245431819482268479,0.000000000000000000000000000000,-0.000000000000003165202487135589,0.000000000000000000000000000000,0.000000000000000000415952902537]
)