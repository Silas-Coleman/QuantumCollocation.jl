"""
This file includes chebyshev integrators for states and unitaries
"""

function nth_order_chebyshev(Gₜ::Matrix, n::Int)
    """
    Compute the nth order chebyshev approximation for the exponential of matrix Gₜ
    
    Inputs:
        Gₜ (Matrix): Matrix to exponetiate and approximate
        n (int): polynomial order of approximation
    
    Returns: nth order chebyshev approximation of the exponential of Gₜ
    """
    @assert n >= 0
    Id = 1.0I(size(Gₜ, 1))
    C = Id * CHEBYSHEV_COEFFICIENTS[0][1]
    if n == 0
        return C
    end
    C = C + (Gₜ * CHEBYSHEV_COEFFICIENTS[1][2])
    if n == 1
        return C
    end
    Gₜ_powers = compute_powers(Gₜ,n)
    for j = 2:n
        C = C + (Id * CHEBYSHEV_COEFFICIENTS[j][1])
        for k = 2:j+1
            C = C + (CHEBYSHEV_COEFFICIENTS[j][k] * Gₜ_powers[k-1])
        end
    end
    return C
end

const CHEBYSHEV_COEFFICIENTS = OrderedDict{Int,Vector{Float64}}(
    0 => [1.266065877752008406176287280687,],
    1 => [0.000000000000000000000000000000,1.130318207984970069190922004054,],
    2 => [-0.271495339534076562948428090749,0.000000000000000000000000000000,0.542990679068153125896856181498,],
    3 => [0.000000000000000000000000000000,-0.133010549545991396680477691916,0.000000000000000000000000000000,0.177347399394655214077687332974,],
    4 => [0.005474240442093732290917973415,0.000000000000000000000000000000,-0.043793923536749858327343787323,0.000000000000000000000000000000,0.043793923536749858327343787323,],
    5 => [0.000000000000000000000000000000,0.002714631559569719021496325695,0.000000000000000000000000000000,-0.010858526238278876085985302780,0.000000000000000000000000000000,0.008686820990623100521843547028,],
    6 => [-0.000044977322954295149168377904,0.000000000000000000000000000000,0.000809591813177312725688383743,0.000000000000000000000000000000,-0.002158911501806167268502356649,0.000000000000000000000000000000,0.001439274334537444773388092933,],
    7 => [0.000000000000000000000000000000,-0.000022389055236813934610280719,0.000000000000000000000000000000,0.000179112441894511476882245748,0.000000000000000000000000000000,-0.000358224883789022953764491497,0.000000000000000000000000000000,0.000204699933593727390534686150,],
    8 => [0.000000199212480667279577239553,0.000000000000000000000000000000,-0.000006374799381352946471665684,0.000000000000000000000000000000,0.000031873996906764730664262525,0.000000000000000000000000000000,-0.000050998395050823571773325471,0.000000000000000000000000000000,0.000025499197525411785886662736,],
    9 => [0.000000000000000000000000000000,0.000000099330945529656097886948,0.000000000000000000000000000000,-0.000001324412607062081234573234,0.000000000000000000000000000000,0.000004767885385423492275057053,0.000000000000000000000000000000,-0.000006357180513897990264764702,0.000000000000000000000000000000,0.000002825413561732440023558429,],
    10 => [-0.000000000550589607967374744813,0.000000000000000000000000000000,0.000000027529480398368735793094,0.000000000000000000000000000000,-0.000000220235843186949886344752,0.000000000000000000000000000000,0.000000616660360923459724116953,0.000000000000000000000000000000,-0.000000704754698198239699830677,0.000000000000000000000000000000,0.000000281901879279295869344359,],
    11 => [0.000000000000000000000000000000,-0.000000000274775227868348071045,0.000000000000000000000000000000,0.000000005495504557366961627702,0.000000000000000000000000000000,-0.000000030774825521254986438622,0.000000000000000000000000000000,0.000000070342458334297106187611,0.000000000000000000000000000000,-0.000000070342458334297106187611,0.000000000000000000000000000000,0.000000025579075757926220431858,],
    12 => [0.000000000001039152230678570007,0.000000000000000000000000000000,-0.000000000074818960608857043725,0.000000000000000000000000000000,0.000000000872887873769998783138,0.000000000000000000000000000000,-0.000000003724321594751994697763,0.000000000000000000000000000000,0.000000007182620218450276197556,0.000000000000000000000000000000,-0.000000006384551305289134122100,0.000000000000000000000000000000,0.000000002128183768429711374033,],
    13 => [0.000000000000000000000000000000,0.000000000000518864236333872231,0.000000000000000000000000000000,-0.000000000014528198617348421255,0.000000000000000000000000000000,0.000000000116225588938787370039,0.000000000000000000000000000000,-0.000000000398487733504413847518,0.000000000000000000000000000000,0.000000000664146222507356429763,0.000000000000000000000000000000,-0.000000000531316978005885164490,0.000000000000000000000000000000,0.000000000163482147078733886824,],
    14 => [-0.000000000000001423758010825657,0.000000000000000000000000000000,0.000000000000139528285060914412,0.000000000000000000000000000000,-0.000000000002232452560974630593,0.000000000000000000000000000000,0.000000000013394715365847781943,0.000000000000000000000000000000,-0.000000000038270615330993666387,0.000000000000000000000000000000,0.000000000056130235818790711132,0.000000000000000000000000000000,-0.000000000040821989686393243285,0.000000000000000000000000000000,0.000000000011663425624683783565,],
    15 => [0.000000000000000000000000000000,-0.000000000000000711138915384224,0.000000000000000000000000000000,0.000000000000026549186174344378,0.000000000000000000000000000000,-0.000000000000286731210682919287,0.000000000000000000000000000000,0.000000000001365386717537710898,0.000000000000000000000000000000,-0.000000000003337611976203293217,0.000000000000000000000000000000,0.000000000004369237496120675036,0.000000000000000000000000000000,-0.000000000002912824997413783222,0.000000000000000000000000000000,0.000000000000776753332643675539,],
    16 => [0.000000000000000001480180057208,0.000000000000000000000000000000,-0.000000000000000189463047322662,0.000000000000000000000000000000,0.000000000000003978723993775911,0.000000000000000000000000000000,-0.000000000000031829791950207290,0.000000000000000000000000000000,0.000000000000125045611232957210,0.000000000000000000000000000000,-0.000000000000266763970630308694,0.000000000000000000000000000000,0.000000000000315266510744910284,0.000000000000000000000000000000,-0.000000000000194010160458406335,0.000000000000000000000000000000,0.000000000000048502540114601584,],
    17 => [0.000000000000000000000000000000,0.000000000000000000739486314141,0.000000000000000000000000000000,-0.000000000000000035495343078747,0.000000000000000000000000000000,0.000000000000000496934803102454,0.000000000000000000000000000000,-0.000000000000003123590190929711,0.000000000000000000000000000000,0.000000000000010411967303099038,0.000000000000000000000000000000,-0.000000000000019688083627678179,0.000000000000000000000000000000,0.000000000000021202551599038040,0.000000000000000000000000000000,-0.000000000000012115743770878880,0.000000000000000000000000000000,0.000000000000002850763240206795,],
    18 => [-0.000000000000000000001207428927,0.000000000000000000000000000000,0.000000000000000000195603486220,0.000000000000000000000000000000,-0.000000000000000005216092965861,0.000000000000000000000000000000,0.000000000000000053551887782836,0.000000000000000000000000000000,-0.000000000000000275409708597442,0.000000000000000000000000000000,0.000000000000000795628047059278,0.000000000000000000000000000000,-0.000000000000001350156685918775,0.000000000000000000000000000000,0.000000000000001335319799260327,0.000000000000000000000000000000,-0.000000000000000712170559605508,0.000000000000000000000000000000,0.000000000000000158260124356779,],
    19 => [0.000000000000000000000000000000,-0.000000000000000000000603317780,0.000000000000000000000000000000,0.000000000000000000036199066806,0.000000000000000000000000000000,-0.000000000000000000637103575780,0.000000000000000000000000000000,0.000000000000000005096828606239,0.000000000000000000000000000000,-0.000000000000000022086257293703,0.000000000000000000000000000000,0.000000000000000056219564020334,0.000000000000000000000000000000,-0.000000000000000086491636954360,0.000000000000000000000000000000,0.000000000000000079078068072558,0.000000000000000000000000000000,-0.000000000000000039539034036279,0.000000000000000000000000000000,0.000000000000000008324007165532,],
    20 => [0.000000000000000000000000793367,0.000000000000000000000000000000,-0.000000000000000000000158673440,0.000000000000000000000000000000,0.000000000000000000005236223520,0.000000000000000000000000000000,-0.000000000000000000067023661053,0.000000000000000000000000000000,0.000000000000000000435653796847,0.000000000000000000000000000000,-0.000000000000000001626440841562,0.000000000000000000000000000000,0.000000000000000003696456458095,0.000000000000000000000000000000,-0.000000000000000005199411281716,0.000000000000000000000000000000,0.000000000000000004419499589458,0.000000000000000000000000000000,-0.000000000000000002079764512686,0.000000000000000000000000000000,0.000000000000000000415952902537,]
)